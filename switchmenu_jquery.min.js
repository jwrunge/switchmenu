function switchin(switch_in,switch_out)
{$(switch_out).animate({left:'-10em',opacity:'0'},300,'swing',function(){$('html, body').scrollTop(0);$(switch_in).scrollTop(0);$(switch_in).css('left','10em').css('opacity','0').show().animate({left:'0',opacity:'1.0'},300,'swing');$(this).hide()})}
var SwitchMenu=function(menu_selector=null,screens=null)
{this.switchin=function(switch_in,switch_out)
{$(switch_out).animate({left:'-10em',opacity:'0'},300,'swing',function(){$('html, body').scrollTop(0);$(switch_in).scrollTop(0);$(switch_in).css('left','10em').css('opacity','0').show().animate({left:'0',opacity:'1.0'},300,'swing');$(this).hide()})}
this.reset=function()
{var screen_class='.'+$(this.menu_selector).prop('id')+'_screen';this.switchin('#'+$(screen_class).first().prop('id'),screen_class);$(this.menu_selector).children('a').removeClass('selected');$(this.menu_selector).children("a[href='"+'#'+$(screen_class).first().prop('id')+"']").addClass('selected')}
this.init=function()
{this.menu_selector=menu_selector;var menu=$(this.menu_selector);menu.addClass('switch_menu');var options=$(menu_selector+' a');var screen_class=menu.prop('id')+'_screen';menu.children('a').first().addClass('selected');menu.prop('data-curScreen',screens[0]);var screenMenuObject=this;$.each(screens,function(index,current_screen)
{if(current_screen!='skip'&&current_screen!=null)
{$(current_screen).addClass(screen_class).css('position','relative');if(index>0)
$(current_screen).css('display','none');$(options[index]).on('click',function(e)
{e.preventDefault();e.stopPropagation();if($(current_screen).css('display')=='none')
{menu.prop('data-curScreen',current_screen);var pages=[];$('.switch_menu').each(function()
{pages.push($(this).prop('data-curScreen'))});history.pushState(pages,null,menu.prop('data-curScreen'));screenMenuObject.switchin(current_screen,'.'+screen_class)}
menu.children('a').removeClass('selected');$(this).addClass('selected')})}})}
this.init()}
window.addEventListener('popstate',function(e){if(e.state)
{if(e.state)
set_state(e.state)}});function set_state(state)
{$('.switch_menu').each(function(index,value)
{if($(state[index]).css('display')=='none')
{if(state[index]!==null)
{switchin(state[index],'.'+$(this).prop('id')+'_screen');$(this).children('a').removeClass('selected');$(this).children("a[href='"+state[index]+"']").addClass('selected')}}})}